#!/bin/sh

echo "Nettoyage des fichier .class"

rm -R src/*/*.class
rm -R src/*.class

echo "Fin du nettoyage"





if [ $# -eq 1 ]
then

    if [ "$1" = "-jar" ] 
    then
        echo "------------------------------------------------------------------------------------------"
        echo "Compilation"
        javac src/Executable.java
        echo "Fin compilation"
        echo "------------------------------------------------------------------------------------------"
        echo "Création du sources.jar"
        jar -cvfm city_builder.jar src/manifest.txt src/*.class src/*/*.class
        echo "Fin création du .jar"
        echo "------------------------------------------------------------------------------------------"
        echo "\tVous pouvez desormais lancer le programme en utilisant la commande : "
        echo "\t\t\t java -jar city_builder.jar"
            
    fi
else 
    if [ $# -eq 2 -a "$1"="-jar" -a "$2"="-clean" ]
    then 
        echo "------------------------------------------------------------------------------------------"
        echo "Compilation"
        javac src/Executable.java
        echo "Fin compilation"
        echo "------------------------------------------------------------------------------------------"
        echo "Création du sources.jar"
        jar -cvfm city_builder.jar src/manifest.txt src/*.class src/*/*.class
        echo "Fin création du .jar"
        echo "------------------------------------------------------------------------------------------"
        echo "\tVous pouvez desormais lancer le programme en utilisant la commande : "
        echo "\t\t\t java -jar city_builder.jar"
        echo "------------------------------------------------------------------------------------------"

        echo "Nettoyage des fichier .class créer pour le jar"

        rm -R src/*/*.class
        rm -R src/*.class

        echo "Fin du nettoyage"

    else
        if [ $# -eq 0 ]
        then
            echo "------------------------------------------------------------------------------------------"
            echo "Compilation"
            javac src/Executable.java
            echo "Compilation finie, lancement du programme avec la commande : java src/Executable"
        else
            echo "------------------------------------------------------------------------------------------"
            echo "Erreur d'utilisation de la commande."
            echo "Usage : "
            echo "\t\t ./src/main.sh option"
            echo "\tOption :"
            echo "\t\t -jar : compile et créer le .jar"
            echo "\t\t -clean : supprime tous les .class sans compiler ni créer le .jar"
            echo "\t\t -jar -clean : créer le .jar et supprime tous les .class créer lors de la création du .jar (l'ordre compte)"
            
        fi
    fi
fi

echo "------------------------------------------------------------------------------------------"
echo "                                Script terminé"
echo "------------------------------------------------------------------------------------------"
